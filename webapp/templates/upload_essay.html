{% extends "template.html" %}


{% load static from staticfiles %}
<html>
<head>
	{% block head_components %}
   	{% endblock %}
</head>
{% block content %}
<body>
	<h3>Upload Essay</h3>
	{% if success %}
		<div class="alert alert-success">
	  		{{success}}
		</div>
	{% endif %}
	<form class="horizontal-form" action="/webapp/submit_essay/" enctype="multipart/form-data" method="post">{%csrf_token%}
		{% for error in form.non_field_errors %}
			<div class="alert alert-danger">
	           Error: {{error}}
	        </div>
        {% endfor %}
        {% for field in form %}
        	{% if field.errors %}
			<div class="alert alert-danger">
            	{{field.errors}}
        	</div>
        	{% endif %}
			<div class="form-group">
				{{field.label}}
				{{field|linebreaks}}
			</div>
		{% endfor %}
		<div class="form-group">
			<input class="btn btn-primary" type="submit" value="Evaluate Essay" />
		</div>
	</form>

	{% if essay_grade %}
		<div class="alert alert-info">
			Essay Grade: {{essay_grade}}
			<br>
			Confidence: {{confidence_score}} %
		</div>
		<h5>Essay Text:</h5>
		<pre>{{essay}}</pre>
		<br>
		<h4>Feedback:</h4>
		<div class="alert alert-info">
			Word Count: {{word_count}} <br>
			Stop Word Count: {{stop_word_count}} <br>
			Spelling Error Count: {{spelling_error_count}} <br>
			Grammer Issues Count: {{grammar_issues_count}}
		</div>
		{% if spelling_error_count > 0 %}

			<h5>Spelling Errors:</h5>
			<div class="alert alert-info">
			{% for word in spelling_errors %}
				{{word|linebreaks}}
			{% endfor %}
			</div>
		{% endif %}
		{% if grammar_issues_count > 0 %}

			<h5>Grammatical Issues:</h5>
			<div class="alert alert-info">

				{% for issue in grammar_issues_list %}
					<pre>{{issue}}</pre>
				{% endfor %}

			</div>

			<p>A list of all grammar rules can be found <a href="https://community.languagetool.org/rule/list?lang=en-US" target="_blank">here</a>.</p>
		{% endif %}

	{% endif %}
</body>
{% endblock %}
</html>
